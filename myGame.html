<!DOCTYPE html>

<html>

  <head>
    <meta charset="UTF-8">
    <title>Canvas</title>

    <style type="text/css">
      canvas {
        
          margin: auto;
          display: block;
          position: absolute;
          border: 1px solid #000;
          top: 0;
          bottom: 0;
          left: 0; 
          right: 0;
          background: #F7F7CC;
          
      }
    </style>

  </head>

  <body>
        
  
    <canvas id="canvas-for-ball" width="800" height="600"></canvas>

    <script type="text/javascript">
	
      // Gets a handle to the element with id canvasOne.
      var canvas = document.getElementById("canvas-for-ball");
      // Get a 2D context for the canvas.
      var ctx = canvas.getContext("2d");
      // Make the fill style red.
      ctx.fillStyle = "rgb(100, 100, 150)";
	  
	 
      var square = {"x": 50, "y": 50, "w": 30, "h": 30, "xv": 10, "yv": 10, "i": 4};
	  
      var food = {"x": 50, "y": 50, "w": 30, "h": 30};

	  //======================================================
	  
	/*  function drawFood() {
    for (var i = 0; i < 100; i++) {
        food.position.x = Math.floor((Math.random() * 500) + 1);
		food.position.y = Math.floor((Math.random() * 500) + 1);
      
        var circle = new Circle(100, speed, size, randomX, randomY);
        circles.push(circle);
    }
    draw();
*/
	  
	  
	  
	  //=====================================================

      
      draw(square.i);
      // Add an event listener to the keypress event.
      window.addEventListener("keydown", function(event) { 
        // Just log the event to the console.
          if (event.keyCode == 38) //up
          {
                square.i = 1;
          }
          else if (event.keyCode == 40) //down
          {
                square.i = 2;
          }
          else if (event.keyCode == 37) //left
          {
                square.i = 3;
          }
          else if (event.keyCode == 39) //right
          {
                square.i = 4;
          }
          
          draw(square.i);

        console.log(event);
      });
        
        var fps = 30;//speed
        var now;
        var then = Date.now();
        var interval = 1000/fps;
        var delta;

        var total = 0;
		
		
		//Location of the random boxes
		food.x = Math.round((Math.random() * 750) + 1)
		food.y = Math.round((Math.random() * 540) + 1);
		//==============================================================
        
        function draw(x) 
        {
			
            window.requestAnimationFrame(draw);

            now = Date.now();
            delta = now - then;
            if (delta > interval) {
                // update time stuffs

                // Just `then = now` is not enough.
                // Lets say we set fps at 10 which means
                // each frame must take 100ms
                // Now frame executes in 16ms (60fps) so
                // the loop iterates 7 times (16*7 = 112ms) until
                // delta > interval === true
                // Eventually this lowers down the FPS as
                // 112*10 = 1120ms (NOT 1000ms).
                // So we have to get rid of that extra 12ms
                // by subtracting delta (112) % interval (100).
                // Hope that makes sense.

                then = now - (delta % interval);

                // ... Code for Drawing the Frame ...
                ctx.clearRect(0, 0, canvas.width, canvas.height);//maintains as a square

			//drawFood.push(food);
			 
            ctx.beginPath();
            //ctx.arc(ball.x, ball.y, ball.r, 0, 2 * Math.PI);
            ctx.fillStyle="rgb(0, 0, 255)";
            ctx.rect(square.x, square.y, square.w, square.h);
            ctx.fill();
			
			     drawFood();

          ctx.fillStyle = "rgb(0,0,0)";
          ctx.font = "22px serif";
          ctx.fillText("Food Collected: " + total, 20, 20);//show user their score 
            
            switch (square.i)
            {
                case 1:
                    if (square.y <= 0)
                    {
                        console.log("Out of bounds (UP)");
                    }
                    else
                    {
                        square.y -= square.yv;
                    }
                    break;
                case 2:
                    if (square.y + square.h >= canvas.height)
                    {
                        console.log("Out of bounds (DOWN)");
                    }
                    else
                    {
                        square.y += square.yv;
                    }
                    break;
                case 3:
                    if (square.x <= 0)
                    {
                        console.log("Out of bounds (LEFT)");
                    }
                    else
                    {
                        square.x -= square.xv;
                    }
                    break;
                case 4:
                    if (square.x + square.w >= canvas.width)
                    {
                        console.log("Out of bounds (RIGHT)");
                    }
                    else
                    {
                        square.x += square.xv; 
                    }
                    break;
                default:
                    console.log("Failed to animate");
                    break;
            }
			   //collision for food    
            if (square.x < food.x + food.w  && square.x + square.w  > food.x &&
    square.y < food.y + food.h && square.y + square.h > food.y) 
            {
              eat();
            }
			
			
        }1000/fps;
		
		function drawFood () {
			ctx.fillStyle="rgb(255, 0, 0)";
      ctx.rect(food.x, food.y, food.w, food.h);
      ctx.fill();
		}
		
		
		function eat() {
			// collision detected!
			food.x = Math.round((Math.random() * 750) + 1);
			food.y = Math.round((Math.random() * 540) + 1);

			total += 1;//adding to your score
			}
			
		
		//This will restart the game when the user hits the bottom of the canvas
		if ((square.x + 30) && (square.y + 30) >= canvas.height ) {
            alert("Game over!");
			document.location.reload();
            
        }
		
		
		
			
	
    }
    </script>
  </body>

</html>